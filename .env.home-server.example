# Home Server Specific Configuration Template
# Copy this file to .env.home-server and customize for your home server setup

# =============================================================================
# HOME SERVER CONFIGURATION
# =============================================================================

# Your home server details
SERVER_HOST=192.168.1.100
SERVER_USER=deploy
SERVER_SSH_PORT=22

# Your domain configuration
DOMAIN_NAME=your-domain.com
SUBDOMAIN_SSO=sso
SUBDOMAIN_TENANT1=tenant-one
SUBDOMAIN_TENANT2=tenant-two

# Full URLs (auto-generated from above)
APP_URL=https://${SUBDOMAIN_SSO}.${DOMAIN_NAME}
TENANT1_URL=https://${SUBDOMAIN_TENANT1}.${DOMAIN_NAME}
TENANT2_URL=https://${SUBDOMAIN_TENANT2}.${DOMAIN_NAME}

# =============================================================================
# CLOUDFLARE TUNNEL CONFIGURATION
# =============================================================================
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_EMAIL=your-email@example.com
CLOUDFLARE_ZONE_ID=your-zone-id
TUNNEL_NAME=sso-home-server

# Tunnel configuration
TUNNEL_METRICS_PORT=9090
TUNNEL_CONFIG_PATH=./cloudflare/config.yml
TUNNEL_CREDENTIALS_PATH=./cloudflare/tunnel-credentials.json

# =============================================================================
# HOME NETWORK CONFIGURATION
# =============================================================================

# Internal network settings
INTERNAL_NETWORK=192.168.1.0/24
DOCKER_SUBNET=172.20.0.0/16

# Resource limits for home server
MEMORY_LIMIT_MARIADB=1G
MEMORY_LIMIT_REDIS=512M
MEMORY_LIMIT_PHP=512M

# =============================================================================
# DEVELOPMENT OVERRIDES FOR HOME SERVER
# =============================================================================

# Enable additional logging for troubleshooting
LOG_LEVEL=info
LOG_CHANNEL=daily
DB_LOG_QUERIES=false

# Enable health check endpoints
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# Telescope (optional for home debugging)
TELESCOPE_ENABLED=false
TELESCOPE_PATH=telescope
TELESCOPE_MIDDLEWARE=auth

# =============================================================================
# BACKUP CONFIGURATION FOR HOME SERVER
# =============================================================================

# Local backup configuration
BACKUP_ENABLED=true
BACKUP_DRIVER=local
BACKUP_PATH=/opt/sso-production/backups
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=7

# Optional cloud backup
BACKUP_CLOUD_ENABLED=false
BACKUP_CLOUD_DRIVER=s3
BACKUP_CLOUD_BUCKET=your-backup-bucket

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Enable basic monitoring
MONITORING_ENABLED=true
METRICS_ENABLED=true
PROMETHEUS_ENABLED=true

# Node exporter for system metrics
NODE_EXPORTER_ENABLED=true
NODE_EXPORTER_PORT=9100

# Application metrics
APP_METRICS_PORT=9090
CLOUDFLARE_METRICS_PORT=9091

# =============================================================================
# SECURITY CONFIGURATION FOR HOME SERVER
# =============================================================================

# Additional security for home exposure
SECURITY_HEADERS_ENABLED=true
RATE_LIMITING_ENABLED=true
IP_WHITELIST_ENABLED=false
IP_WHITELIST=""

# Fail2ban integration (if available)
FAIL2BAN_ENABLED=false

# =============================================================================
# PERFORMANCE TUNING FOR HOME SERVER
# =============================================================================

# PHP-FPM Configuration
PHP_FPM_MAX_CHILDREN=20
PHP_FPM_START_SERVERS=5
PHP_FPM_MIN_SPARE_SERVERS=5
PHP_FPM_MAX_SPARE_SERVERS=10

# Database configuration for limited resources
DB_INNODB_BUFFER_POOL_SIZE=512M
DB_MAX_CONNECTIONS=100
DB_QUERY_CACHE_SIZE=32M

# Redis configuration
REDIS_MAXMEMORY=256M
REDIS_MAXMEMORY_POLICY=allkeys-lru

# =============================================================================
# HOME SERVER SCRIPTS CONFIGURATION
# =============================================================================

# Deployment scripts
DEPLOY_SCRIPT_PATH=./scripts/home-server-deploy.sh
BACKUP_SCRIPT_PATH=./scripts/backup-home-server.sh
UPDATE_SCRIPT_PATH=./scripts/update-home-server.sh

# Script scheduling
CRON_BACKUP="0 2 * * *"
CRON_UPDATE="0 3 1 * *"
CRON_CLEANUP="0 4 * * 0"

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================

# Email notifications for system events
NOTIFICATION_EMAIL_ENABLED=true
NOTIFICATION_EMAIL=admin@your-domain.com

# Slack notifications (optional)
NOTIFICATION_SLACK_ENABLED=false
NOTIFICATION_SLACK_WEBHOOK=your-slack-webhook-url

# Discord notifications (optional)
NOTIFICATION_DISCORD_ENABLED=false
NOTIFICATION_DISCORD_WEBHOOK=your-discord-webhook-url

# =============================================================================
# DOCKER COMPOSE CONFIGURATION
# =============================================================================

# Compose files to use
COMPOSE_FILE=docker-compose.yml:docker-compose.production.yml:docker-compose.cloudflare.yml

# Docker registry (if using private registry)
DOCKER_REGISTRY=ghcr.io
DOCKER_REGISTRY_USERNAME=your-github-username
DOCKER_REGISTRY_TOKEN=your-github-token

# Image tags
IMAGE_TAG=latest
CENTRAL_SSO_IMAGE=${DOCKER_REGISTRY}/your-username/sso-central:${IMAGE_TAG}
TENANT1_IMAGE=${DOCKER_REGISTRY}/your-username/sso-tenant1:${IMAGE_TAG}
TENANT2_IMAGE=${DOCKER_REGISTRY}/your-username/sso-tenant2:${IMAGE_TAG}

# =============================================================================
# DEVELOPMENT AND TESTING
# =============================================================================

# Enable development features in home environment
DEV_MODE=false
DEBUG_TOOLBAR=false
QUERY_DEBUGGING=false

# Testing configuration
TESTING_ENABLED=true
TEST_DATABASE=sso_testing
TEST_REDIS_DB=1

# =============================================================================
# SSL CERTIFICATE CONFIGURATION
# =============================================================================

# Cloudflare SSL settings
SSL_MODE=flexible
SSL_ALWAYS_USE_HTTPS=true
SSL_HSTS_ENABLED=true
SSL_HSTS_MAX_AGE=31536000

# Custom SSL (if not using Cloudflare)
CUSTOM_SSL_ENABLED=false
SSL_CERT_PATH=/etc/ssl/certs/your-domain.crt
SSL_KEY_PATH=/etc/ssl/private/your-domain.key

# =============================================================================
# FIREWALL AND NETWORK SECURITY
# =============================================================================

# UFW firewall rules
UFW_ENABLED=true
UFW_SSH_PORT=22
UFW_DOCKER_ENABLED=true

# Allowed IPs (comma-separated)
ALLOWED_IPS=""

# DDoS protection
DDOS_PROTECTION_ENABLED=true
RATE_LIMIT_PER_IP=100

# =============================================================================
# SYSTEM ADMINISTRATION
# =============================================================================

# Automatic updates
AUTO_UPDATES_ENABLED=true
AUTO_RESTART_ENABLED=false

# Log rotation
LOG_ROTATION_ENABLED=true
LOG_RETENTION_DAYS=30

# Disk space monitoring
DISK_MONITORING_ENABLED=true
DISK_WARNING_THRESHOLD=80
DISK_CRITICAL_THRESHOLD=90

# =============================================================================
# TROUBLESHOOTING CONFIGURATION
# =============================================================================

# Debug modes (enable temporarily for troubleshooting)
DEBUG_DOCKER=false
DEBUG_NETWORK=false
DEBUG_SSL=false
DEBUG_AUTH=false

# Verbose logging
VERBOSE_LOGS=false
TRACE_REQUESTS=false

# =============================================================================
# CUSTOMIZATION FOR YOUR SETUP
# =============================================================================

# Replace these values with your actual configuration:

# 1. Update domain name:
#    DOMAIN_NAME=yourdomain.com

# 2. Update server IP:
#    SERVER_HOST=your-server-ip

# 3. Update Cloudflare credentials:
#    CLOUDFLARE_API_TOKEN=your-token
#    CLOUDFLARE_EMAIL=your-email
#    CLOUDFLARE_ZONE_ID=your-zone-id

# 4. Update notification settings:
#    NOTIFICATION_EMAIL=your-email@domain.com

# 5. Adjust resource limits based on your server:
#    MEMORY_LIMIT_MARIADB=1G (adjust based on available RAM)
#    MEMORY_LIMIT_REDIS=512M (adjust based on available RAM)

# =============================================================================
# SECURITY NOTES FOR HOME SERVER
# =============================================================================

# 1. Change default SSH port: SSH_PORT=2222
# 2. Use key-based SSH authentication only
# 3. Enable UFW firewall and configure rules
# 4. Regularly update system packages
# 5. Monitor logs for suspicious activity
# 6. Use strong passwords and rotate them regularly
# 7. Consider VPN access for additional security
# 8. Enable fail2ban if available
# 9. Backup configuration files regularly
# 10. Test disaster recovery procedures