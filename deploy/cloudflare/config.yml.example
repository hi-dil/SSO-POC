# Cloudflare Tunnel Configuration
# Copy this file to cloudflare/config.yml and update with your tunnel details

tunnel: YOUR_TUNNEL_UUID_HERE
credentials-file: /etc/cloudflared/tunnel-credentials.json

# Ingress rules - Routes external domains to internal services
ingress:
  # Central SSO Server
  - hostname: sso.poc.hi-dil.com
    service: http://central-sso:8000
    
  # Tenant 1 Application  
  - hostname: tenant-one.poc.hi-dil.com
    service: http://tenant1-app:8000
    
  # Tenant 2 Application
  - hostname: tenant-two.poc.hi-dil.com
    service: http://tenant2-app:8000
    
  # Optional: Admin interface with IP restrictions
  - hostname: admin.poc.hi-dil.com
    service: http://central-sso:8000
    originRequest:
      # Add IP restrictions for admin access
      headers:
        X-Admin-Access: "true"
    
  # Catch-all rule (required - must be last)
  - service: http_status:404

# Optional: Tunnel-level configuration
metrics: 0.0.0.0:8080
no-autoupdate: true
logfile: /var/log/cloudflared.log
loglevel: info

# Optional: Origin request configuration
originRequest:
  connectTimeout: 30s
  tlsTimeout: 10s
  tcpKeepAlive: 30s
  noHappyEyeballs: false
  keepAliveConnections: 100
  keepAliveTimeout: 90s
  httpHostHeader: ""
  originServerName: ""
  caPool: ""
  noTLSVerify: false
  disableChunkedEncoding: false
  bastionMode: false
  proxyAddress: ""
  proxyPort: 0
  proxyType: ""