# MariaDB Security Configuration
# This file contains security settings for production deployment

[mysqld]
# Network Security
bind-address = 0.0.0.0
port = 3306
skip-networking = 0
skip-name-resolve = 1

# SSL/TLS Configuration
ssl-ca = /etc/mysql/ssl/ca.pem
ssl-cert = /etc/mysql/ssl/server-cert.pem
ssl-key = /etc/mysql/ssl/server-key.pem
require-secure-transport = ON

# Security Settings
local-infile = 0
secure-file-priv = /tmp
symbolic-links = 0

# Authentication
default-authentication-plugin = mysql_native_password

# Logging and Monitoring
log-error = /var/log/mysql/error.log
slow-query-log = 1
slow-query-log-file = /var/log/mysql/slow.log
long-query-time = 2
log-queries-not-using-indexes = 1

# Performance and Security Limits
max-connections = 100
max-user-connections = 50
max-connect-errors = 10
connect-timeout = 10
wait-timeout = 600
interactive-timeout = 600

# Buffer Sizes (Security focused)
key-buffer-size = 128M
max-allowed-packet = 16M
thread-stack = 256K
thread-cache-size = 8
myisam-recover-options = BACKUP

# InnoDB Security
innodb-file-per-table = 1
innodb-flush-log-at-trx-commit = 1
innodb-lock-wait-timeout = 50

# Binary Log Security
log-bin = mysql-bin
binlog-format = MIXED
expire-logs-days = 7
max-binlog-size = 100M

# Query Cache (Disabled for security)
query-cache-type = 0
query-cache-size = 0

# Security Hardening
skip-show-database
sql-mode = STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

[mysql]
ssl-ca = /etc/mysql/ssl/ca.pem
ssl-cert = /etc/mysql/ssl/client-cert.pem
ssl-key = /etc/mysql/ssl/client-key.pem

[client]
ssl-ca = /etc/mysql/ssl/ca.pem
ssl-cert = /etc/mysql/ssl/client-cert.pem
ssl-key = /etc/mysql/ssl/client-key.pem