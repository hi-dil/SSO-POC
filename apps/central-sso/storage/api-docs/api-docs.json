{
    "openapi": "3.0.0",
    "info": {
        "title": "SSO Authentication API",
        "description": "Single Sign-On API for multi-tenant authentication",
        "contact": {
            "name": "SSO Admin",
            "email": "admin@sso.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:8000/api",
            "description": "Development server"
        }
    ],
    "paths": {
        "/auth/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Authenticate user and get JWT token",
                "description": "Login with email and password for a specific tenant",
                "operationId": "login",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponseDTO"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Access denied to tenant",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new user",
                "description": "Register a new user for a specific tenant",
                "operationId": "register",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RegisterRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponseDTO"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Tenant not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/validate": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Validate JWT token",
                "description": "Validate a JWT token and return user information",
                "operationId": "validateToken",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "token": {
                                        "description": "JWT token to validate",
                                        "type": "string"
                                    },
                                    "tenant_slug": {
                                        "description": "Tenant slug",
                                        "type": "string"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Token validation result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ValidateTokenResponseDTO"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Token not valid for tenant",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/auth/user": {
            "get": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Get current authenticated user",
                "description": "Get the current authenticated user information",
                "operationId": "getUser",
                "responses": {
                    "200": {
                        "description": "User information",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "user": {
                                            "$ref": "#/components/schemas/UserResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/auth/refresh": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Refresh JWT token",
                "description": "Refresh an existing JWT token",
                "operationId": "refreshToken",
                "responses": {
                    "200": {
                        "description": "Token refreshed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "token": {
                                            "type": "string"
                                        },
                                        "expires_in": {
                                            "type": "integer",
                                            "example": 3600
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Could not refresh token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/auth/logout": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout user",
                "description": "Invalidate the current JWT token",
                "operationId": "logout",
                "responses": {
                    "200": {
                        "description": "Successfully logged out",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Successfully logged out"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Could not log out",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ErrorResponseDTO"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/audit/login": {
            "post": {
                "tags": [
                    "Audit"
                ],
                "summary": "Record a login audit event",
                "description": "Record a login event from a tenant application",
                "operationId": "recordLoginAudit",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginAuditRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login audit recorded successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuditResponseDTO"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found in central SSO",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuditResponseDTO"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuditResponseDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/audit/logout": {
            "post": {
                "tags": [
                    "Audit"
                ],
                "summary": "Record a logout audit event",
                "description": "Record a logout event from a tenant application",
                "operationId": "recordLogoutAudit",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LogoutAuditRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Logout audit recorded successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuditResponseDTO"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AuditResponseDTO"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/permissions": {
            "get": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Get all permissions",
                "operationId": "a49af5d462a91e9996aa5342b6de4ddd",
                "parameters": [
                    {
                        "name": "category",
                        "in": "query",
                        "description": "Filter by category",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "include_system",
                        "in": "query",
                        "description": "Include system permissions",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": true
                        }
                    },
                    {
                        "name": "include_roles",
                        "in": "query",
                        "description": "Include roles count",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/PermissionResponseDTO"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Create a new permission",
                "operationId": "6ef531e33f8fca9c42d3e8fcaf30d5b4",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreatePermissionRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Permission created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Permission created successfully"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/PermissionResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/permissions/{id}": {
            "get": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Get a specific permission",
                "operationId": "16db55c19d22dca89994e416d7dd28be",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Permission ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/PermissionResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Permission not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Update a permission",
                "operationId": "c5094a50888fb3f3f1254fea3140241a",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Permission ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreatePermissionRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Permission updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Permission updated successfully"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/PermissionResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Cannot update system permission"
                    },
                    "404": {
                        "description": "Permission not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Delete a permission",
                "operationId": "d0a14d107d6e379b9b3b5207f5c76e8e",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Permission ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Permission deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Permission deleted successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Cannot delete system permission"
                    },
                    "404": {
                        "description": "Permission not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/permissions/categories": {
            "get": {
                "tags": [
                    "Permissions"
                ],
                "summary": "Get all permission categories",
                "operationId": "4ce1a133b412d635004855347a3fb188",
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            },
                                            "example": [
                                                "users",
                                                "roles",
                                                "tenants",
                                                "system",
                                                "api"
                                            ]
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/roles": {
            "get": {
                "tags": [
                    "Roles"
                ],
                "summary": "Get all roles",
                "operationId": "ca86f0a206144dfbd695b749b4b28f9d",
                "parameters": [
                    {
                        "name": "include_permissions",
                        "in": "query",
                        "description": "Include permissions in response",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "include_system",
                        "in": "query",
                        "description": "Include system roles",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": true
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/RoleResponseDTO"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Roles"
                ],
                "summary": "Create a new role",
                "operationId": "341b8b162b61267c7bd187500aea5bc4",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateRoleRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Role created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Role created successfully"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/RoleResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Validation failed"
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/roles/{id}": {
            "get": {
                "tags": [
                    "Roles"
                ],
                "summary": "Get a specific role",
                "operationId": "15c404caf238f1861c81f68205d328e5",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Role ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/RoleResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Role not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Roles"
                ],
                "summary": "Update a role",
                "operationId": "c73ab816ae8fb7c34a995d37ba577082",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Role ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateRoleRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Role updated successfully"
                                        },
                                        "data": {
                                            "$ref": "#/components/schemas/RoleResponseDTO"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Cannot update system role"
                    },
                    "404": {
                        "description": "Role not found"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Roles"
                ],
                "summary": "Delete a role",
                "operationId": "ffa6ef115d86b00cc6c54a6210019f9c",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Role ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Role deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Role deleted successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Cannot delete system role"
                    },
                    "404": {
                        "description": "Role not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users/{userId}/roles": {
            "get": {
                "tags": [
                    "User Roles"
                ],
                "summary": "Get all roles for a user",
                "operationId": "80db853ae3da5c6ec92fbe7f0cfe5594",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "path",
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "tenant_id",
                        "in": "query",
                        "description": "Filter by tenant ID",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "include_global",
                        "in": "query",
                        "description": "Include global roles",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": true
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "role": {
                                                        "$ref": "#/components/schemas/RoleResponseDTO"
                                                    },
                                                    "tenant_id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "User Roles"
                ],
                "summary": "Assign a role to a user",
                "operationId": "e684531bf9fd2149269bc2ba8632055e",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "path",
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AssignRoleRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role assigned successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Role assigned successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Role already assigned"
                    },
                    "404": {
                        "description": "User or role not found"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "User Roles"
                ],
                "summary": "Remove a role from a user",
                "operationId": "194107adc837850909fba4c12b238100",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "path",
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AssignRoleRequestDTO"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role removed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Role removed successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Role not assigned to user"
                    },
                    "404": {
                        "description": "User or role not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users/{userId}/roles/sync": {
            "put": {
                "tags": [
                    "User Roles"
                ],
                "summary": "Sync roles for a user in a specific tenant",
                "operationId": "b8a420e8bdf861fa6700a69f48e45855",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "path",
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "roles": {
                                        "description": "Array of role slugs to assign",
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "example": [
                                            "admin",
                                            "manager"
                                        ]
                                    },
                                    "tenant_id": {
                                        "description": "Tenant ID (null for global roles)",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Roles synced successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Roles synced successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users/{userId}/permissions": {
            "get": {
                "tags": [
                    "User Roles"
                ],
                "summary": "Get all permissions for a user through roles",
                "operationId": "95ac0183a7931a73420841eccadcc284",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "path",
                        "description": "User ID",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "tenant_id",
                        "in": "query",
                        "description": "Filter by tenant ID",
                        "required": false,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/PermissionResponseDTO"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "components": {
        "schemas": {
            "AssignRoleRequestDTO": {
                "required": [
                    "role_slug"
                ],
                "properties": {
                    "role_slug": {
                        "description": "Role slug to assign",
                        "type": "string",
                        "example": "manager"
                    },
                    "tenant_id": {
                        "description": "Tenant ID for tenant-specific role assignment (optional for global roles)",
                        "type": "integer",
                        "example": 1
                    }
                },
                "type": "object"
            },
            "CreatePermissionRequestDTO": {
                "title": "Create Permission Request DTO",
                "description": "Request DTO for creating permissions",
                "required": [
                    "name"
                ],
                "properties": {
                    "name": {
                        "description": "Permission name",
                        "type": "string",
                        "example": "Create Reports"
                    },
                    "slug": {
                        "description": "Permission slug (auto-generated if not provided)",
                        "type": "string",
                        "example": "reports.create"
                    },
                    "description": {
                        "description": "Permission description",
                        "type": "string",
                        "example": "Can create new reports"
                    },
                    "category": {
                        "description": "Permission category",
                        "type": "string",
                        "example": "reports"
                    }
                },
                "type": "object"
            },
            "CreateRoleRequestDTO": {
                "required": [
                    "name"
                ],
                "properties": {
                    "name": {
                        "description": "Role name",
                        "type": "string",
                        "example": "Manager"
                    },
                    "slug": {
                        "description": "Role slug (auto-generated if not provided)",
                        "type": "string",
                        "example": "manager"
                    },
                    "description": {
                        "description": "Role description",
                        "type": "string",
                        "example": "Can manage users and view reports"
                    },
                    "permissions": {
                        "description": "Array of permission slugs to assign to this role",
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "example": [
                            "users.view",
                            "users.create",
                            "reports.view"
                        ]
                    }
                },
                "type": "object"
            },
            "LoginAuditRequestDTO": {
                "title": "Login Audit Request DTO",
                "description": "Request DTO for recording login audit events",
                "required": [
                    "email",
                    "tenant_id",
                    "login_method",
                    "is_successful"
                ],
                "properties": {
                    "user_id": {
                        "description": "User ID (optional)",
                        "type": "integer",
                        "example": 123
                    },
                    "email": {
                        "description": "User email address",
                        "type": "string",
                        "format": "email",
                        "example": "user@example.com"
                    },
                    "tenant_id": {
                        "description": "Tenant identifier",
                        "type": "string",
                        "example": "tenant1"
                    },
                    "login_method": {
                        "description": "Login method used",
                        "type": "string",
                        "enum": [
                            "sso",
                            "direct",
                            "api"
                        ],
                        "example": "direct"
                    },
                    "is_successful": {
                        "description": "Whether the login was successful",
                        "type": "boolean",
                        "example": true
                    },
                    "failure_reason": {
                        "description": "Reason for login failure (if applicable)",
                        "type": "string",
                        "example": "Invalid credentials"
                    },
                    "ip_address": {
                        "description": "Client IP address",
                        "type": "string",
                        "format": "ip",
                        "example": "192.168.1.1"
                    },
                    "user_agent": {
                        "description": "Client user agent",
                        "type": "string",
                        "example": "Mozilla/5.0..."
                    },
                    "session_id": {
                        "description": "Session identifier",
                        "type": "string",
                        "example": "sess_abc123"
                    }
                },
                "type": "object"
            },
            "LoginRequestDTO": {
                "required": [
                    "email",
                    "password",
                    "tenant_slug"
                ],
                "properties": {
                    "email": {
                        "description": "User's email address",
                        "type": "string",
                        "format": "email",
                        "example": "superadmin@sso.com"
                    },
                    "password": {
                        "description": "User's password",
                        "type": "string",
                        "format": "password",
                        "example": "password"
                    },
                    "tenant_slug": {
                        "description": "Tenant slug",
                        "type": "string",
                        "example": "tenant1"
                    }
                },
                "type": "object"
            },
            "LogoutAuditRequestDTO": {
                "title": "Logout Audit Request DTO",
                "description": "Request DTO for recording logout audit events",
                "required": [
                    "session_id",
                    "tenant_id"
                ],
                "properties": {
                    "session_id": {
                        "description": "Session identifier",
                        "type": "string",
                        "example": "sess_abc123"
                    },
                    "tenant_id": {
                        "description": "Tenant identifier",
                        "type": "string",
                        "example": "tenant1"
                    }
                },
                "type": "object"
            },
            "RegisterRequestDTO": {
                "required": [
                    "name",
                    "email",
                    "password",
                    "password_confirmation"
                ],
                "properties": {
                    "name": {
                        "description": "User's full name",
                        "type": "string",
                        "example": "John Doe"
                    },
                    "email": {
                        "description": "User's email address",
                        "type": "string",
                        "format": "email",
                        "example": "john.doe@example.com"
                    },
                    "password": {
                        "description": "User's password (minimum 8 characters)",
                        "type": "string",
                        "format": "password",
                        "example": "password123"
                    },
                    "password_confirmation": {
                        "description": "Password confirmation",
                        "type": "string",
                        "format": "password",
                        "example": "password123"
                    },
                    "tenant_slug": {
                        "description": "Tenant slug for registration",
                        "type": "string",
                        "example": "tenant1"
                    }
                },
                "type": "object"
            },
            "ValidateTokenRequestDTO": {
                "required": [
                    "token"
                ],
                "properties": {
                    "token": {
                        "description": "JWT token to validate",
                        "type": "string",
                        "example": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    }
                },
                "type": "object"
            },
            "AuditResponseDTO": {
                "title": "Audit Response DTO",
                "description": "Response DTO for audit operations",
                "properties": {
                    "success": {
                        "description": "Operation success status",
                        "type": "boolean",
                        "example": true
                    },
                    "audit_id": {
                        "description": "Audit record ID",
                        "type": "integer",
                        "example": 123
                    },
                    "message": {
                        "description": "Response message",
                        "type": "string",
                        "example": "Audit recorded successfully"
                    }
                },
                "type": "object"
            },
            "ErrorResponseDTO": {
                "properties": {
                    "success": {
                        "description": "Always false for error responses",
                        "type": "boolean",
                        "example": false
                    },
                    "message": {
                        "description": "Error message",
                        "type": "string",
                        "example": "Something went wrong"
                    },
                    "errors": {
                        "description": "Validation errors",
                        "type": "object",
                        "example": {
                            "field": [
                                "Field is required"
                            ]
                        },
                        "additionalProperties": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    },
                    "code": {
                        "description": "HTTP status code",
                        "type": "integer",
                        "example": 400
                    }
                },
                "type": "object"
            },
            "LoginResponseDTO": {
                "properties": {
                    "success": {
                        "description": "Whether the login was successful",
                        "type": "boolean",
                        "example": true
                    },
                    "token": {
                        "description": "JWT authentication token",
                        "type": "string",
                        "example": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                    },
                    "user": {
                        "$ref": "#/components/schemas/UserResponseDTO"
                    },
                    "message": {
                        "description": "Success or error message",
                        "type": "string",
                        "example": "Login successful"
                    },
                    "errors": {
                        "description": "Validation errors (if any)",
                        "type": "object",
                        "example": {
                            "email": [
                                "The email field is required."
                            ]
                        },
                        "additionalProperties": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    }
                },
                "type": "object"
            },
            "PermissionResponseDTO": {
                "properties": {
                    "id": {
                        "description": "Permission ID",
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "description": "Permission name",
                        "type": "string",
                        "example": "View Users"
                    },
                    "slug": {
                        "description": "Permission slug",
                        "type": "string",
                        "example": "users.view"
                    },
                    "description": {
                        "description": "Permission description",
                        "type": "string",
                        "example": "Allows viewing user list and details"
                    },
                    "category": {
                        "description": "Permission category",
                        "type": "string",
                        "example": "users"
                    },
                    "is_system": {
                        "description": "Whether the permission is a system permission",
                        "type": "boolean",
                        "example": false
                    },
                    "roles_count": {
                        "description": "Number of roles with this permission",
                        "type": "integer",
                        "example": 3
                    },
                    "created_at": {
                        "description": "Creation timestamp",
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-08-16T12:00:00Z"
                    },
                    "updated_at": {
                        "description": "Last update timestamp",
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-08-16T12:00:00Z"
                    }
                },
                "type": "object"
            },
            "RoleResponseDTO": {
                "properties": {
                    "id": {
                        "description": "Role ID",
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "description": "Role name",
                        "type": "string",
                        "example": "Manager"
                    },
                    "slug": {
                        "description": "Role slug",
                        "type": "string",
                        "example": "manager"
                    },
                    "description": {
                        "description": "Role description",
                        "type": "string",
                        "example": "Can manage users and view reports"
                    },
                    "is_system": {
                        "description": "Whether the role is a system role",
                        "type": "boolean",
                        "example": false
                    },
                    "permissions": {
                        "description": "List of permissions assigned to this role",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/PermissionResponseDTO"
                        }
                    },
                    "users_count": {
                        "description": "Number of users with this role",
                        "type": "integer",
                        "example": 5
                    },
                    "created_at": {
                        "description": "Creation timestamp",
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-08-16T12:00:00Z"
                    },
                    "updated_at": {
                        "description": "Last update timestamp",
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-08-16T12:00:00Z"
                    }
                },
                "type": "object"
            },
            "UserResponseDTO": {
                "properties": {
                    "id": {
                        "description": "User ID",
                        "type": "integer",
                        "example": 1
                    },
                    "name": {
                        "description": "User's full name",
                        "type": "string",
                        "example": "John Doe"
                    },
                    "email": {
                        "description": "User's email address",
                        "type": "string",
                        "format": "email",
                        "example": "john.doe@example.com"
                    },
                    "tenants": {
                        "description": "List of tenant slugs the user has access to",
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "example": [
                            "tenant1",
                            "tenant2"
                        ]
                    },
                    "current_tenant": {
                        "description": "Current active tenant slug",
                        "type": "string",
                        "example": "tenant1"
                    },
                    "is_admin": {
                        "description": "Whether the user is an admin",
                        "type": "boolean",
                        "example": false
                    }
                },
                "type": "object"
            },
            "ValidateTokenResponseDTO": {
                "properties": {
                    "valid": {
                        "description": "Whether the token is valid",
                        "type": "boolean",
                        "example": true
                    },
                    "user": {
                        "$ref": "#/components/schemas/UserResponseDTO"
                    },
                    "message": {
                        "description": "Validation message",
                        "type": "string",
                        "example": "Token is valid"
                    },
                    "expires_at": {
                        "description": "Token expiration date",
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-08-16T12:00:00Z"
                    }
                },
                "type": "object"
            }
        },
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Audit",
            "description": "Login audit management endpoints"
        },
        {
            "name": "Permissions",
            "description": "Permission management endpoints"
        },
        {
            "name": "Roles",
            "description": "Role management endpoints"
        },
        {
            "name": "User Roles",
            "description": "User role assignment and management endpoints"
        },
        {
            "name": "Authentication",
            "description": "Authentication"
        }
    ]
}